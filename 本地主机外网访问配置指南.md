# 本地主机外网访问配置指南

## 配置步骤

### 1. 确认服务器配置（已完成）
- 服务器已配置为监听所有网络接口（0.0.0.0）
- 默认端口为5000（如被占用会自动选择其他端口）

### 2. 配置Windows防火墙
1. 以管理员身份运行PowerShell或命令提示符
2. 执行以下命令开放服务器端口：
   ```powershell
   netsh advfirewall firewall add rule name="Flask Web App Port 5000" dir=in action=allow protocol=TCP localport=5000
   netsh advfirewall firewall add rule name="Flask Web App Port 5000" dir=out action=allow protocol=TCP localport=5000
   ```
3. 如果使用其他端口，请相应修改命令中的端口号

### 3. 路由器端口转发设置
1. 登录路由器管理界面（通常是 http://192.168.1.1 或 http://192.168.0.1）
2. 找到"端口转发"或"虚拟服务器"设置
3. 添加新的端口转发规则：
   - 外部端口：选择一个外部访问端口（建议使用5000以上的端口）
   - 内部端口：5000（或你的服务器实际使用的端口）
   - 内部IP地址：你的服务器本地IP地址
   - 协议：TCP
   - 启用规则

### 4. 安全访问控制
1. 修改管理员密码（如果还没有修改）
2. 在config.py中添加IP访问限制（可选）
3. 建议启用HTTPS（需要配置SSL证书）

### 5. 测试访问
1. 在局域网内测试：
   - 使用 http://本机IP:端口 访问
2. 在外网测试：
   - 使用 http://你的公网IP:外部端口 访问
   - 或者使用 http://你的域名:外部端口 访问（如果有域名）

## 注意事项

### 安全警告
1. 确保管理员密码足够强大
2. 定期检查访问日志
3. 建议使用HTTPS加密传输
4. 避免在公网暴露敏感信息

### 故障排除
1. 如果无法访问，请依次检查：
   - 服务器是否正常运行
   - 防火墙规则是否正确配置
   - 路由器端口转发是否正确设置
   - 本地端口是否被其他程序占用

2. 常见错误：
   - 端口被占用：尝试更换其他端口
   - 防火墙阻止：检查防火墙规则
   - 路由器配置错误：验证端口转发设置

### 维护建议
1. 定期备份数据库
2. 监控服务器状态
3. 及时更新安全补丁
4. 保持系统和依赖库的更新

## 快速启动指南

1. 启动服务器：
   ```bash
   python run_web.py
   ```

2. 查看服务器信息：
   ```bash
   python get_access_info.py
   ```

3. 记录服务器地址：
   - 本地访问：http://localhost:5000
   - 局域网访问：http://本机IP:5000
   - 外网访问：http://公网IP:外部端口